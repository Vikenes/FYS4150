\section{Results}\label{sec:results}
\subsection{Analytical comparison}\label{subsec_results:analytical}
The comparison between the numerical and analytical values of various quantities is given in table \ref{tab:compare_analytical}. The first column shows the total number of cycles run for each of the measured quantities, i.e. these results are obtained \textit{without} equilibrating the system first. Here, we see that we get reasonable good estimates of the average quantities, even for $\nmc=10^2$. For $nmc=10^4$ and $10^5$ we obtain reasonable approximation of the estimates. However, some fluctuations are to be expected since these are after all numerical approximations. 

\begin{table}[!ht]
    \input{tables/compare_analytical.tex}
    \caption{Comparison of analytical results. }
    \label{tab:compare_analytical}
\end{table}


\subsection{Equilibration time}\label{subsec_results:equilibriation_time}
Figure \ref{fig:equil_energy} and \ref{fig:equil_magn} shows the evolution of $\avge$ for an ordered and unordered initial lattice configuration. A logarithmic scale is used on the $x$-axis. The result for $T=1\tunit$ and $T=2.4\tunit$ are shown in the left and right panel, respectively. For $T=1\tunit$ we see that an ordered initial configuration quickly approaches the equilibrium value, as aligned spins are favored at low temperature. We see that $\nmc>10^3$ is required for the unordered configuration to reach close to the equilibrium value. For $T=2.4\tunit$ we see that both lattice configurations require an approximate value of $10^4$ cycles in order to equilibrate the system, as higher temperatures favor less alignment of spins.    
\begin{figure}[!ht]
    \includegraphics[width=\linewidth]{pdfs/equilibriation_time_energy.pdf}
    \caption{Equilibration time for the mean energy $\langle \epsilon \rangle $ as function of the number of Monte Carlo cycles, $\nmc$, for $T=1\tunit$ and $T=2.4\tunit$. The red line correspond to an ordered initial state in which all the spins point in the same direction. The blue line correspond to an unordered initial state with random initialization of the spins.}
    \label{fig:equil_energy}
\end{figure}
The evolution of $\avgm$ in Fig. \ref{fig:equil_magn} shows a similar behavior to that of $\avge$ in Fig. \ref{fig:equil_energy}. An ordered lattice configuration reaches the equilibrium values after very few iterations for $T=1\tunit$, compared to the unordered configuration. At $T=2.4\tunit$ both configurations require $\nmc\approx10^4$ for equilibrium to be reached. 

Based on these plots we choose $\nequi=1.5\cdot10^4$ for further analysis. In Figs. \ref{fig:equil_energy} and \ref{fig:equil_magn} we saw that an approximate equilibrium was reached after $10^4$ cycles. There are statistical uncertainties in our results due to considering one sample only, and we therefore choose the slightly higher value of $\nequi=1.5\cdot10^4$. This value is also small enough for the simulations to be computationally efficient.

\begin{figure}[!ht]
    \includegraphics[width=\linewidth]{pdfs/equilibriation_time_magnetization.pdf}
    \caption{Equilibration time for the mean magnetization $\langle \vert m \vert \rangle$ as function of the number of Monte Carlo cycles, $\nmc$, for $T=1\tunit$ and $T=2.4\tunit$. The red line correspond to an ordered initial state in which all the spins point in the same direction. The blue line correspond to an unordered initial state with random initialization of the spins.}
    \label{fig:equil_magn}
\end{figure}

\subsection{Energy histograms}\label{subsec_results:histogram}
We generate samples of $\eps$ from $\nmc=10^5$ cycles for $T=1\tunit$ and $T=2.4\tunit$, with resulting histograms shown in Fig. \ref{fig:histogram}. For $T=1\tunit$ we see that the distribution has a mean and variance of $\avge\approx-2\eunit$ and $\sigma(\eps)^2\approx5.91\cdot10^{-5}\eunit$, with more than $80\,\%$ of the samples are drawn from microstates consisting of aligned spins where $\eps=-2\eunit$. We notice that there are no samples in which $\eps=-1.99$, which would correspond to a single spin having the opposite orientation from the others. From equation \eqref{eq:DeltaE_from_single_spin_flip} we see that this is due to flipping a single spin leads to the largest possible value of $\Delta E=8\eunit$, rendering configurations with a single anti-aligned spin very improbable.

For $T=2.4\tunit$, we see in the right panel of Fig. \ref{fig:histogram} that the energy of the system is distributed over a larger range, with $\avge\approx-1.24\eunit$ and $\sigma(\eps)^2 \approx2.03\cdot10^{-2}\eunit$. We see that there are no energy values around the mean that are inaccessible, compared to the low-temperature distribution in the left panel. 
\begin{figure}[!ht]
    \includegraphics[width=\linewidth]{pdfs/histogram.pdf}
    \caption{Estimates of the probability distribution $p_e(\epsilon; T)$ for $T=1\tunit$ and $T=2.4$. For $T=1\tunit$ the expectation value is $\langle \epsilon \rangle = -2.00 \; J$ with variance $\sigma^2 = 5.91\cdot 10^{-5}$, while for $T=2.4$ the expectation value is $\langle \epsilon \rangle = -1.24 \; J$ with variance $\sigma^2=2.03\cdot 10^{-2}$.}
    \label{fig:histogram}
\end{figure}

\subsection{Phase transition}\label{subsec_results:phase_transition}
Using $\nmc=10^5$ and $\nequi=1.5\cdot10^4$, the estimated value of $C_V$ and $\chi$ are plotted for $T\in[2,2.5]\tunit$ in the left and right panel of Fig. \ref{fig:phase_transition}, respectively. We see a clear indication of a phase transition taking place, as both quantities shows diverging behavior near $T\sim2.3\tunit$. Since $C_V$ is expected to diverge logarithmically, the maximum values differ little as we increase lattice size, compared to the maximum values we see for $\chi$. With large variations of $\chi$ near the critical temperature, with respect to both lattice size and temperature, small statistical fluctuations can have a great impact on the predicted values of $T_C(L)$. To extract estimates of $T_C(L)$ we will therefore consider the heat capacity only in further investigations. 
\begin{figure*}[!ht]
    \includegraphics[width=\linewidth]{pdfs/phase_transitionNT50.pdf} 
    \caption{Heat capacity $C_V$ and magnetic susceptibility $\chi$ for lattices of different sizes $L\in\{40,60,80,100\}$ for temperatures $T\in[2.0,2.5]\tunit$. In both panels we see clear indications of the power rule behavior these properties exhibit around their critical temperatures.}
    \label{fig:phase_transition}
\end{figure*} 

We estimate $C_V$ for $T\in[2.25,2.35]\tunit$, with a spacing of $\Delta T=10^{-3}$. To reduce the uncertainty of the measured averages, we now run $\nmc=10^6$ cycles for each temperature value, using $\nequi=1.5\cdot10^4$ still. The result is shown in Fig. \ref{fig:phase_transition_zoomed}, where dots represent the measured value of $C_V$ for individual lattice sizes at each temperature, and the dashed lines represent the resulting fit from a cubic spline. The maximum points of the fitted function for the different lattice sizes is shown in the figure. It is also worth noticing the increase in variance of the estimates heat capacities as the lattice size increase.
\begin{figure}[!ht]
    \includegraphics[width=\linewidth]{pdfs/phase_transitionNT101.pdf} 
    \caption{Close up analysis for the heat capacity $C_V$ for $T\in[2.25, 2.35]$ with maximum points estimated from an interpolation of the data points for each lattice size. These are shown as orange markers in the plot.}
    \label{fig:phase_transition_zoomed}
\end{figure} 

Using the estimated values of $T_C(L)$, we perform linear regression with respect to inverse lattice sizes, and estimate approximate values for $a$ and $T_C(L=\infty)$ from Eq. \eqref{eq:onsager_critical_temperature}. The result of the linear regression is shown in Fig. \ref{fig:critical_temperatures}, with the individual estimates of $T_C(L)$ included in the figure. The points corresponding to the lattice of size $L=\infty$ is also shown in the figure. We emphasize that the negative values on the $x$-axis in Fig. \ref{fig:critical_temperatures} is un-physical, and is only included to better see the estimated value of the critical temperature. The linear regression resulted in a slope of $a=0.888$ and an intercept of $T_C(L=\infty)=2.2651\tunit$.     
\begin{figure}[!ht]
    \includegraphics[width=\linewidth]{pdfs/critical_temperatures.pdf} 
    \caption{Linear fit of the critical temperatures. The fit is made from the orange markers in the plot, as a function of the inverse lattice size. The critical temperature for an infinite lattice is found as the intercept of this linear fit and is marked with red in the plot. }
    \label{fig:critical_temperatures}
\end{figure} 

In table \ref{tab:critical_temperatures} we present the estimated values of the critical temperatures. The second column shows the estimated value of $T_C(L)$ from the maximum value of the fitted heat capacity. The critical temperature at different lattice sizes according to the linear regression is shown in the third column. In the fourth column we have included the mean squared error (MSE) between the heat capacity data and the fit. Uncertainties related to errors like these were not accounted for when performing linear regression. The last row represents the infinite size lattice. The discrepancy between our estimate of $T_C(L=\infty)$ and the true value is thus $\Delta T_C(L=\infty)\approx4.1\cdot10^{-3}\tunit$. In section \ref{sec:discussion} we will discuss more in detail the validity of our results, with a particular emphasis on how to improve some of the results we have obtained, as well as some limitations of our methods in general.    
\begin{table}[!ht]
    \input{tables/critical_temperatures.tex}
    \caption{Critical temperatures for different lattice sizes found both from curve fit and linear regression. $T_C(L=\infty)$ is estimated from linear regression only.}
    \label{tab:critical_temperatures}
\end{table}

% =========================================== 